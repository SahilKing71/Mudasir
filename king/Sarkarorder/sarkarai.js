const _0x4fe5d2=_0x486e;(function(_0x3df930,_0xcc5ab3){const _0x506f2c=_0x486e,_0x463a56=_0x3df930();while(!![]){try{const _0x48b370=parseInt(_0x506f2c(0x195))/0x1+-parseInt(_0x506f2c(0x192))/0x2+-parseInt(_0x506f2c(0x18e))/0x3+-parseInt(_0x506f2c(0x18c))/0x4*(-parseInt(_0x506f2c(0x19d))/0x5)+parseInt(_0x506f2c(0x199))/0x6+parseInt(_0x506f2c(0x1a0))/0x7*(-parseInt(_0x506f2c(0x1a7))/0x8)+parseInt(_0x506f2c(0x190))/0x9;if(_0x48b370===_0xcc5ab3)break;else _0x463a56['push'](_0x463a56['shift']());}catch(_0x4a376b){_0x463a56['push'](_0x463a56['shift']());}}}(_0x1910,0xc1612));import{promises as _0x217571}from'fs';import _0x42a47d from'path';import _0x44bfe2 from'node-fetch';import _0xc11ef3 from'../../config.cjs';const __filename=new URL(import.meta[_0x4fe5d2(0x193)])['pathname'],__dirname=_0x42a47d[_0x4fe5d2(0x1ab)](__filename),chatHistoryFile=_0x42a47d['resolve'](__dirname,_0x4fe5d2(0x188));function _0x1910(){const _0x3e4cfa=['body','4354104XfrNss','*EXAMPLE:\x20','includes','API\x20returned\x20status\x20','470EHjweB','split','API','56dshitv','gpt\x20who\x20is\x20Elon\x20Musk?*','stringify','Something\x20went\x20wrong.\x20Please\x20try\x20again\x20later.','Failed\x20to\x20delete\x20chat\x20history.\x20Please\x20try\x20again\x20later.','Error\x20deleting\x20chat\x20history:','utf-8','560192KTmkhE','message','slice','user','dirname','Error\x20writing\x20chat\x20history:','push','bot','sender','data','status','error','json','from','../gpt_history.json','PREFIX','text','parse','26812bLwmgX','shift','4613670lfRvIC','Error:','19093905CZpwME','writeFile','2918510LsBgQS','url','Invalid\x20API\x20response\x20structure','872108rJdXEB','length','sendMessage'];_0x1910=function(){return _0x3e4cfa;};return _0x1910();}function _0x486e(_0x3f34e8,_0xfacf24){const _0x191047=_0x1910();return _0x486e=function(_0x486e6b,_0x57e38a){_0x486e6b=_0x486e6b-0x180;let _0x1ecfff=_0x191047[_0x486e6b];return _0x1ecfff;},_0x486e(_0x3f34e8,_0xfacf24);}async function readChatHistoryFromFile(){const _0x339c0c=_0x4fe5d2;try{const _0xcec0a1=await _0x217571['readFile'](chatHistoryFile,_0x339c0c(0x1a6));return JSON[_0x339c0c(0x18b)](_0xcec0a1);}catch{return{};}}async function writeChatHistoryToFile(_0xa27bc2){const _0x282bba=_0x4fe5d2;try{await _0x217571[_0x282bba(0x191)](chatHistoryFile,JSON[_0x282bba(0x1a2)](_0xa27bc2,null,0x2));}catch(_0x271308){console[_0x282bba(0x185)](_0x282bba(0x1ac),_0x271308);}}async function deleteChatHistory(_0x24396b,_0x4bc13d){const _0xf6d946=_0x4fe5d2;try{delete _0x24396b[_0x4bc13d],await writeChatHistoryToFile(_0x24396b);}catch(_0x1b5308){console['error'](_0xf6d946(0x1a5),_0x1b5308);}}async function updateChatHistory(_0x2fc7df,_0x189bd8,_0x4009b3){const _0x782476=_0x4fe5d2;try{!_0x2fc7df[_0x189bd8]&&(_0x2fc7df[_0x189bd8]=[]),_0x2fc7df[_0x189bd8][_0x782476(0x180)](_0x4009b3),_0x2fc7df[_0x189bd8][_0x782476(0x196)]>0x14&&_0x2fc7df[_0x189bd8][_0x782476(0x18d)](),await writeChatHistoryToFile(_0x2fc7df);}catch(_0x404a38){console['error']('Error\x20updating\x20chat\x20history:',_0x404a38);}}const mistral=async(_0x17ae20,_0x4cce27)=>{const _0x1ab9db=_0x4fe5d2,_0x426c73=await readChatHistoryFromFile(),_0x4869c6=_0x17ae20[_0x1ab9db(0x198)]['trim']();if(_0x4869c6==='/forget'){try{await deleteChatHistory(_0x426c73,_0x17ae20[_0x1ab9db(0x182)]),await _0x4cce27['sendMessage'](_0x17ae20['from'],{'text':'Chat\x20history\x20deleted\x20successfully.'},{'quoted':_0x17ae20});}catch(_0x14fa8b){console[_0x1ab9db(0x185)](_0x1ab9db(0x1a5),_0x14fa8b),await _0x4cce27['sendMessage'](_0x17ae20[_0x1ab9db(0x187)],{'text':_0x1ab9db(0x1a4)},{'quoted':_0x17ae20});}return;}const _0x3614ee=_0xc11ef3[_0x1ab9db(0x189)];if(!_0x4869c6['startsWith'](_0x3614ee))return;const _0x2792bc=_0x4869c6['slice'](_0x3614ee[_0x1ab9db(0x196)])[_0x1ab9db(0x19e)]('\x20')[0x0]['toLowerCase'](),_0x25eaf0=_0x4869c6[_0x1ab9db(0x1a9)](_0x3614ee[_0x1ab9db(0x196)]+_0x2792bc[_0x1ab9db(0x196)])['trim'](),_0x155b31=['gpt',_0x1ab9db(0x181),'ai'];if(!_0x155b31[_0x1ab9db(0x19b)](_0x2792bc))return;if(!_0x25eaf0){await _0x4cce27[_0x1ab9db(0x197)](_0x17ae20[_0x1ab9db(0x187)],{'text':_0x1ab9db(0x19a)+_0x3614ee+_0x1ab9db(0x1a1)},{'quoted':_0x17ae20});return;}try{const _0x3acf34='*AI\x20GPT\x20is\x20processing\x20your\x20request\x20please\x20wait...*';await _0x4cce27[_0x1ab9db(0x197)](_0x17ae20['from'],{'text':_0x3acf34},{'quoted':_0x17ae20});const _0x54f8f3='https://api.siputzx.my.id/api/ai/copilot?text='+encodeURIComponent(_0x25eaf0),_0x17cba5=await _0x44bfe2(_0x54f8f3);if(!_0x17cba5['ok']){const _0x230e83=await _0x17cba5[_0x1ab9db(0x18a)]();throw new Error(_0x1ab9db(0x19c)+_0x17cba5[_0x1ab9db(0x184)]+':\x20'+_0x230e83);}const _0x342b3f=await _0x17cba5[_0x1ab9db(0x186)](),_0x410915=_0x342b3f?.[_0x1ab9db(0x183)];if(!_0x410915)throw new Error(_0x1ab9db(0x194));await updateChatHistory(_0x426c73,_0x17ae20[_0x1ab9db(0x182)],{'role':_0x1ab9db(0x1aa),'content':_0x25eaf0}),await updateChatHistory(_0x426c73,_0x17ae20[_0x1ab9db(0x182)],{'role':'assistant','content':_0x410915});const _0x444a59=_0x17ae20['pushName']||'User',_0x2bb6c2='Here\x27s\x20your\x20response,\x20'+_0x444a59+':\x0a\x0a'+_0x410915;await _0x4cce27[_0x1ab9db(0x197)](_0x17ae20[_0x1ab9db(0x187)],{'text':_0x2bb6c2},{'quoted':_0x17ae20});}catch(_0x3cf355){console[_0x1ab9db(0x185)](_0x1ab9db(0x18f),_0x3cf355);const _0x24e54c=_0x3cf355[_0x1ab9db(0x1a8)][_0x1ab9db(0x19b)](_0x1ab9db(0x19f))?'The\x20AI\x20service\x20is\x20currently\x20unavailable.\x20Please\x20try\x20again\x20later.':_0x1ab9db(0x1a3);await _0x4cce27[_0x1ab9db(0x197)](_0x17ae20[_0x1ab9db(0x187)],{'text':_0x24e54c},{'quoted':_0x17ae20});}};export default mistral;
